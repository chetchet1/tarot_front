<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vue Router í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            min-height: 100vh;
            margin: 0;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
            margin-bottom: 40px;
        }
        .test-section {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
        }
        .test-section h2 {
            color: #FFD700;
            margin-bottom: 20px;
        }
        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        button {
            background: linear-gradient(135deg, #A855F7 0%, #8B5CF6 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(168, 85, 247, 0.4);
        }
        .log-area {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            font-family: monospace;
            font-size: 14px;
            max-height: 300px;
            overflow-y: auto;
        }
        .log-entry {
            margin: 5px 0;
            padding: 5px;
            border-left: 3px solid #A855F7;
            padding-left: 10px;
        }
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .status.success {
            background: rgba(34, 197, 94, 0.2);
            border: 1px solid #22c55e;
        }
        .status.error {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid #ef4444;
        }
        .status.info {
            background: rgba(59, 130, 246, 0.2);
            border: 1px solid #3b82f6;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”® Vue Router ê³µìœ  í˜ì´ì§€ í…ŒìŠ¤íŠ¸</h1>
        
        <div class="test-section">
            <h2>ğŸ“Š í˜„ì¬ ìƒíƒœ</h2>
            <div id="status-container"></div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ§ª ë„¤ë¹„ê²Œì´ì…˜ í…ŒìŠ¤íŠ¸</h2>
            <div class="btn-group">
                <button onclick="navigateTo('/')">í™ˆìœ¼ë¡œ</button>
                <button onclick="navigateTo('/app')">ì•±ìœ¼ë¡œ</button>
                <button onclick="navigateTo('/s/test-123')">ê³µìœ  í˜ì´ì§€ (í…ŒìŠ¤íŠ¸)</button>
                <button onclick="navigateTo('/s/bfd0c8e8-09c1-4c79-8ae1-3eb093f858d7')">ê³µìœ  í˜ì´ì§€ (ì‹¤ì œ ID)</button>
                <button onclick="createNewSharedLink()">ìƒˆ ê³µìœ  ë§í¬ ìƒì„±</button>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ” Vue ì•± ì§„ë‹¨</h2>
            <div class="btn-group">
                <button onclick="checkVueApp()">Vue ì•± í™•ì¸</button>
                <button onclick="checkRouter()">ë¼ìš°í„° í™•ì¸</button>
                <button onclick="checkCurrentRoute()">í˜„ì¬ ë¼ìš°íŠ¸ í™•ì¸</button>
                <button onclick="checkSharedComponent()">ê³µìœ  ì»´í¬ë„ŒíŠ¸ í™•ì¸</button>
                <button onclick="clearLogs()">ë¡œê·¸ ì§€ìš°ê¸°</button>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“œ ë¡œê·¸</h2>
            <div id="log-area" class="log-area"></div>
        </div>
    </div>
    
    <script>
        const logArea = document.getElementById('log-area');
        const statusContainer = document.getElementById('status-container');
        
        function addLog(message, type = 'info') {
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            const timestamp = new Date().toLocaleTimeString('ko-KR');
            entry.innerHTML = `<strong>[${timestamp}]</strong> ${message}`;
            logArea.appendChild(entry);
            logArea.scrollTop = logArea.scrollHeight;
        }
        
        function updateStatus() {
            const statusItems = [];
            
            // URL ì •ë³´
            statusItems.push({
                label: 'URL',
                value: window.location.href,
                type: 'info'
            });
            
            // Vue ì•± ìƒíƒœ
            const vueApp = document.querySelector('#app')?.__vue_app__;
            statusItems.push({
                label: 'Vue ì•±',
                value: vueApp ? 'âœ… ë¡œë“œë¨' : 'âŒ ì—†ìŒ',
                type: vueApp ? 'success' : 'error'
            });
            
            // Vue Router ìƒíƒœ
            const hasRouter = vueApp && vueApp.config.globalProperties.$router;
            statusItems.push({
                label: 'Vue Router',
                value: hasRouter ? 'âœ… í™œì„±' : 'âŒ ë¹„í™œì„±',
                type: hasRouter ? 'success' : 'error'
            });
            
            // í˜„ì¬ ë¼ìš°íŠ¸
            if (hasRouter) {
                const currentRoute = vueApp.config.globalProperties.$route;
                statusItems.push({
                    label: 'í˜„ì¬ ë¼ìš°íŠ¸',
                    value: currentRoute ? currentRoute.path : 'ì•Œ ìˆ˜ ì—†ìŒ',
                    type: 'info'
                });
            }
            
            // ê³µìœ  ì»´í¬ë„ŒíŠ¸ ë¡œë“œ ìƒíƒœ
            const sharedLoaded = window.__SHARED_READING_LOADED__;
            statusItems.push({
                label: 'ê³µìœ  ì»´í¬ë„ŒíŠ¸',
                value: sharedLoaded ? 'âœ… ë¡œë“œë¨' : 'âŒ ë¡œë“œ ì•ˆë¨',
                type: sharedLoaded ? 'success' : 'error'
            });
            
            statusContainer.innerHTML = statusItems.map(item => 
                `<div class="status ${item.type}">
                    <strong>${item.label}:</strong> ${item.value}
                </div>`
            ).join('');
        }
        
        function navigateTo(path) {
            addLog(`ğŸš€ ${path}ë¡œ ì´ë™ ì‹œë„...`);
            
            // Vue Routerê°€ ìˆìœ¼ë©´ ì‚¬ìš©
            const vueApp = document.querySelector('#app')?.__vue_app__;
            if (vueApp && vueApp.config.globalProperties.$router) {
                const router = vueApp.config.globalProperties.$router;
                router.push(path)
                    .then(() => {
                        addLog(`âœ… ${path}ë¡œ ì´ë™ ì„±ê³µ`);
                        setTimeout(updateStatus, 100);
                    })
                    .catch(err => {
                        addLog(`âŒ ë¼ìš°í„° ì´ë™ ì‹¤íŒ¨: ${err.message}`, 'error');
                    });
            } else {
                // ì¼ë°˜ í˜ì´ì§€ ì´ë™
                window.location.href = path;
            }
        }
        
        function checkVueApp() {
            const appElement = document.querySelector('#app');
            const vueApp = appElement?.__vue_app__;
            
            if (!appElement) {
                addLog('âŒ #app ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤', 'error');
                return;
            }
            
            if (!vueApp) {
                addLog('âŒ Vue ì•±ì´ ë§ˆìš´íŠ¸ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤', 'error');
                addLog('ğŸ’¡ íŒ: ê°œë°œ ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸í•˜ì„¸ìš”');
                return;
            }
            
            addLog('âœ… Vue ì•± ë°œê²¬!');
            addLog(`ì•± ë²„ì „: ${vueApp.version}`);
            
            // ì „ì—­ ì†ì„± í™•ì¸
            const globalProps = vueApp.config.globalProperties;
            const propKeys = Object.keys(globalProps);
            addLog(`ì „ì—­ ì†ì„±: ${propKeys.join(', ')}`);
        }
        
        function checkRouter() {
            const vueApp = document.querySelector('#app')?.__vue_app__;
            
            if (!vueApp) {
                addLog('âŒ Vue ì•±ì´ ì—†ìŠµë‹ˆë‹¤', 'error');
                return;
            }
            
            const router = vueApp.config.globalProperties.$router;
            
            if (!router) {
                addLog('âŒ Vue Routerê°€ ì—†ìŠµë‹ˆë‹¤', 'error');
                return;
            }
            
            addLog('âœ… Vue Router ë°œê²¬!');
            
            // ë¼ìš°íŠ¸ ëª©ë¡
            const routes = router.getRoutes();
            addLog(`ë“±ë¡ëœ ë¼ìš°íŠ¸ ìˆ˜: ${routes.length}`);
            
            // ê³µìœ  ê´€ë ¨ ë¼ìš°íŠ¸ ì°¾ê¸°
            const shareRoutes = routes.filter(r => r.path.includes('/s/'));
            if (shareRoutes.length > 0) {
                addLog('ğŸ“‹ ê³µìœ  ê´€ë ¨ ë¼ìš°íŠ¸:');
                shareRoutes.forEach(route => {
                    addLog(`  - ${route.path} (${route.name})`);
                });
            } else {
                addLog('âš ï¸ ê³µìœ  ê´€ë ¨ ë¼ìš°íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤', 'warning');
            }
        }
        
        function checkCurrentRoute() {
            const vueApp = document.querySelector('#app')?.__vue_app__;
            
            if (!vueApp) {
                addLog('âŒ Vue ì•±ì´ ì—†ìŠµë‹ˆë‹¤', 'error');
                return;
            }
            
            const route = vueApp.config.globalProperties.$route;
            
            if (!route) {
                addLog('âŒ í˜„ì¬ ë¼ìš°íŠ¸ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤', 'error');
                return;
            }
            
            addLog('ğŸ“ í˜„ì¬ ë¼ìš°íŠ¸ ì •ë³´:');
            addLog(`  ê²½ë¡œ: ${route.path}`);
            addLog(`  ì´ë¦„: ${route.name || 'ì—†ìŒ'}`);
            addLog(`  íŒŒë¼ë¯¸í„°: ${JSON.stringify(route.params)}`);
            addLog(`  ì¿¼ë¦¬: ${JSON.stringify(route.query)}`);
            addLog(`  ë©”íƒ€: ${JSON.stringify(route.meta)}`);
        }
        
        function checkSharedComponent() {
            addLog('ğŸ” ê³µìœ  ì»´í¬ë„ŒíŠ¸ í™•ì¸ ì¤‘...');
            
            // ì „ì—­ ë³€ìˆ˜ í™•ì¸
            if (window.__SHARED_READING_LOADED__) {
                addLog('âœ… SharedReading ì»´í¬ë„ŒíŠ¸ê°€ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤');
                if (window.__SHARED_READING_ID__) {
                    addLog(`  ê³µìœ  ID: ${window.__SHARED_READING_ID__}`);
                }
            } else {
                addLog('âŒ SharedReading ì»´í¬ë„ŒíŠ¸ê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤');
            }
            
            // Vue ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ í™•ì¸
            const vueApp = document.querySelector('#app')?.__vue_app__;
            if (vueApp) {
                // í˜„ì¬ ì»´í¬ë„ŒíŠ¸ í™•ì¸
                const root = vueApp._instance;
                if (root) {
                    addLog('ğŸŒ³ ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ í™•ì¸ ì¤‘...');
                    // Vue 3ì—ì„œëŠ” ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ íƒìƒ‰ì´ ë³µì¡í•¨
                    addLog('  (Vue DevToolsë¥¼ ì‚¬ìš©í•˜ì—¬ ë” ìì„¸íˆ í™•ì¸ ê°€ëŠ¥)');
                }
            }
        }
        
        async function createNewSharedLink() {
            addLog('ğŸ”„ ìƒˆ ê³µìœ  ë§í¬ ìƒì„± ì‹œë„...');
            
            try {
                // Supabase ì§ì ‘ í˜¸ì¶œ (í…ŒìŠ¤íŠ¸ìš©)
                const testData = {
                    id: 'test-' + Date.now(),
                    spread_type: 'three_card',
                    cards: [
                        { cardNumber: 0, nameKr: 'ë°”ë³´', orientation: 'upright' },
                        { cardNumber: 1, nameKr: 'ë§ˆë²•ì‚¬', orientation: 'reversed' },
                        { cardNumber: 2, nameKr: 'ì—¬ì‚¬ì œ', orientation: 'upright' }
                    ],
                    basic_interpretation: 'í…ŒìŠ¤íŠ¸ í•´ì„ì…ë‹ˆë‹¤.',
                    custom_question: 'í…ŒìŠ¤íŠ¸ ì§ˆë¬¸',
                    expires_at: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString(),
                    is_active: true
                };
                
                addLog(`âœ… í…ŒìŠ¤íŠ¸ ê³µìœ  ID ìƒì„±: ${testData.id}`);
                addLog(`ğŸ“‹ /s/${testData.id} ë¡œ ì´ë™í•´ë³´ì„¸ìš”`);
                
                // ìë™ìœ¼ë¡œ ì´ë™
                setTimeout(() => {
                    navigateTo(`/s/${testData.id}`);
                }, 1000);
                
            } catch (error) {
                addLog(`âŒ ê³µìœ  ë§í¬ ìƒì„± ì‹¤íŒ¨: ${error.message}`, 'error');
            }
        }
        
        function clearLogs() {
            logArea.innerHTML = '';
            addLog('ğŸ“œ ë¡œê·¸ê°€ ì§€ì›Œì¡ŒìŠµë‹ˆë‹¤');
        }
        
        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', () => {
            updateStatus();
            addLog('ğŸš€ í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ë¡œë“œë¨');
            
            // 1ì´ˆ í›„ Vue ì•± í™•ì¸
            setTimeout(() => {
                checkVueApp();
                updateStatus();
            }, 1000);
            
            // ìƒíƒœ ìë™ ì—…ë°ì´íŠ¸
            setInterval(updateStatus, 5000);
        });
        
        // ë¼ìš°íŠ¸ ë³€ê²½ ê°ì§€
        window.addEventListener('popstate', () => {
            addLog('ğŸ“ ë¸Œë¼ìš°ì € íˆìŠ¤í† ë¦¬ ë³€ê²½ë¨');
            updateStatus();
        });
    </script>
</body>
</html>

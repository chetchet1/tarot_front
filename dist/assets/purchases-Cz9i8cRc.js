const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./web-BpJ1DT7n.js","./index-xMamrl6d.js","./index-BBlcRgQE.css"])))=>i.map(i=>d[i]);
import{l as M,m as L,u as N,n as U}from"./index-xMamrl6d.js";var B=function(){var t=function(r,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,n){o.__proto__=n}||function(o,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(o[s]=n[s])},t(r,e)};return function(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(r,e);function o(){this.constructor=r}r.prototype=e===null?Object.create(e):(o.prototype=e.prototype,new o)}}(),c;(function(t){t.UNKNOWN_ERROR="0",t.PURCHASE_CANCELLED_ERROR="1",t.STORE_PROBLEM_ERROR="2",t.PURCHASE_NOT_ALLOWED_ERROR="3",t.PURCHASE_INVALID_ERROR="4",t.PRODUCT_NOT_AVAILABLE_FOR_PURCHASE_ERROR="5",t.PRODUCT_ALREADY_PURCHASED_ERROR="6",t.RECEIPT_ALREADY_IN_USE_ERROR="7",t.INVALID_RECEIPT_ERROR="8",t.MISSING_RECEIPT_FILE_ERROR="9",t.NETWORK_ERROR="10",t.INVALID_CREDENTIALS_ERROR="11",t.UNEXPECTED_BACKEND_RESPONSE_ERROR="12",t.RECEIPT_IN_USE_BY_OTHER_SUBSCRIBER_ERROR="13",t.INVALID_APP_USER_ID_ERROR="14",t.OPERATION_ALREADY_IN_PROGRESS_ERROR="15",t.UNKNOWN_BACKEND_ERROR="16",t.INVALID_APPLE_SUBSCRIPTION_KEY_ERROR="17",t.INELIGIBLE_ERROR="18",t.INSUFFICIENT_PERMISSIONS_ERROR="19",t.PAYMENT_PENDING_ERROR="20",t.INVALID_SUBSCRIBER_ATTRIBUTES_ERROR="21",t.LOG_OUT_ANONYMOUS_USER_ERROR="22",t.CONFIGURATION_ERROR="23",t.UNSUPPORTED_ERROR="24",t.EMPTY_SUBSCRIBER_ATTRIBUTES_ERROR="25",t.PRODUCT_DISCOUNT_MISSING_IDENTIFIER_ERROR="26",t.PRODUCT_DISCOUNT_MISSING_SUBSCRIPTION_GROUP_IDENTIFIER_ERROR="28",t.CUSTOMER_INFO_ERROR="29",t.SYSTEM_INFO_ERROR="30",t.BEGIN_REFUND_REQUEST_ERROR="31",t.PRODUCT_REQUEST_TIMED_OUT_ERROR="32",t.API_ENDPOINT_BLOCKED="33",t.INVALID_PROMOTIONAL_OFFER_ERROR="34",t.OFFLINE_CONNECTION_ERROR="35"})(c||(c={}));(function(t){B(r,t);function r(){var e=t.call(this,"There is no singleton instance. Make sure you configure Purchases before trying to get the default instance. More info here: https://errors.rev.cat/configuring-sdk")||this;return Object.setPrototypeOf(e,r.prototype),e}return r})(Error);(function(t){B(r,t);function r(){var e=t.call(this,"This method is not available in the current platform.")||this;return Object.setPrototypeOf(e,r.prototype),e}return r})(Error);var u;(function(t){t.UNKNOWN="UNKNOWN",t.CUSTOM="CUSTOM",t.LIFETIME="LIFETIME",t.ANNUAL="ANNUAL",t.SIX_MONTH="SIX_MONTH",t.THREE_MONTH="THREE_MONTH",t.TWO_MONTH="TWO_MONTH",t.MONTHLY="MONTHLY",t.WEEKLY="WEEKLY"})(u||(u={}));var a;(function(t){t[t.INTRO_ELIGIBILITY_STATUS_UNKNOWN=0]="INTRO_ELIGIBILITY_STATUS_UNKNOWN",t[t.INTRO_ELIGIBILITY_STATUS_INELIGIBLE=1]="INTRO_ELIGIBILITY_STATUS_INELIGIBLE",t[t.INTRO_ELIGIBILITY_STATUS_ELIGIBLE=2]="INTRO_ELIGIBILITY_STATUS_ELIGIBLE",t[t.INTRO_ELIGIBILITY_STATUS_NO_INTRO_OFFER_EXISTS=3]="INTRO_ELIGIBILITY_STATUS_NO_INTRO_OFFER_EXISTS"})(a||(a={}));var _;(function(t){t.NON_SUBSCRIPTION="NON_SUBSCRIPTION",t.SUBSCRIPTION="SUBSCRIPTION",t.UNKNOWN="UNKNOWN"})(_||(_={}));var f;(function(t){t.CONSUMABLE="CONSUMABLE",t.NON_CONSUMABLE="NON_CONSUMABLE",t.NON_RENEWABLE_SUBSCRIPTION="NON_RENEWABLE_SUBSCRIPTION",t.AUTO_RENEWABLE_SUBSCRIPTION="AUTO_RENEWABLE_SUBSCRIPTION",t.PREPAID_SUBSCRIPTION="PREPAID_SUBSCRIPTION",t.UNKNOWN="UNKNOWN"})(f||(f={}));var R;(function(t){t[t.UNKNOWN_SUBSCRIPTION_UPGRADE_DOWNGRADE_POLICY=0]="UNKNOWN_SUBSCRIPTION_UPGRADE_DOWNGRADE_POLICY",t[t.IMMEDIATE_WITH_TIME_PRORATION=1]="IMMEDIATE_WITH_TIME_PRORATION",t[t.IMMEDIATE_AND_CHARGE_PRORATED_PRICE=2]="IMMEDIATE_AND_CHARGE_PRORATED_PRICE",t[t.IMMEDIATE_WITHOUT_PRORATION=3]="IMMEDIATE_WITHOUT_PRORATION",t[t.DEFERRED=4]="DEFERRED",t[t.IMMEDIATE_AND_CHARGE_FULL_PRICE=5]="IMMEDIATE_AND_CHARGE_FULL_PRICE"})(R||(R={}));var T;(function(t){t[t.INFINITE_RECURRING=1]="INFINITE_RECURRING",t[t.FINITE_RECURRING=2]="FINITE_RECURRING",t[t.NON_RECURRING=3]="NON_RECURRING"})(T||(T={}));var O;(function(t){t.FREE_TRIAL="FREE_TRIAL",t.SINGLE_PAYMENT="SINGLE_PAYMENT",t.DISCOUNTED_RECURRING_PAYMENT="DISCOUNTED_RECURRING_PAYMENT"})(O||(O={}));var l;(function(t){t.DAY="DAY",t.WEEK="WEEK",t.MONTH="MONTH",t.YEAR="YEAR",t.UNKNOWN="UNKNOWN"})(l||(l={}));var S;(function(t){t.INAPP="inapp",t.SUBS="subs"})(S||(S={}));var E;(function(t){t[t.SUBSCRIPTIONS=0]="SUBSCRIPTIONS",t[t.SUBSCRIPTIONS_UPDATE=1]="SUBSCRIPTIONS_UPDATE",t[t.IN_APP_ITEMS_ON_VR=2]="IN_APP_ITEMS_ON_VR",t[t.SUBSCRIPTIONS_ON_VR=3]="SUBSCRIPTIONS_ON_VR",t[t.PRICE_CHANGE_CONFIRMATION=4]="PRICE_CHANGE_CONFIRMATION"})(E||(E={}));var p;(function(t){t[t.SUCCESS=0]="SUCCESS",t[t.USER_CANCELLED=1]="USER_CANCELLED",t[t.ERROR=2]="ERROR"})(p||(p={}));var d;(function(t){t.VERBOSE="VERBOSE",t.DEBUG="DEBUG",t.INFO="INFO",t.WARN="WARN",t.ERROR="ERROR"})(d||(d={}));const i=M("Purchases",{web:()=>L(()=>import("./web-BpJ1DT7n.js"),__vite__mapDeps([0,1,2]),import.meta.url).then(t=>new t.PurchasesWeb)}),v=async()=>{await i.configure("your_revenuecat_ios_key");const r=N();r.currentUser&&!r.currentUser.isAnonymous&&await i.logIn(r.currentUser.id)},h=async()=>{try{return(await i.getOfferings()).all}catch(t){return console.error("Failed to get offerings:",t),[]}},A=async t=>{var r,e,o,n;try{const s=N(),I=await i.purchasePackage(t);return I.customerInfo.activeSubscriptions.length>0?(await U.createSubscription({user_id:(r=s.currentUser)==null?void 0:r.id,plan:t.identifier.includes("yearly")?"yearly":"monthly",status:"active",price:t.product.price,currency:t.product.currencyCode,platform_order_id:(e=I.transaction)==null?void 0:e.transactionIdentifier,start_date:new Date,end_date:y(t.identifier)}),s.updateSubscription({id:((o=I.transaction)==null?void 0:o.transactionIdentifier)||"",userId:((n=s.currentUser)==null?void 0:n.id)||"",plan:t.identifier.includes("yearly")?"yearly":"monthly",status:"active",startDate:new Date,endDate:y(t.identifier),price:t.product.price,currency:t.product.currencyCode}),{success:!0,customerInfo:I.customerInfo}):{success:!1,error:"No active subscription found"}}catch(s){return console.error("Purchase failed:",s),{success:!1,error:s}}},W=async()=>{var t;try{const r=N(),e=await i.restorePurchases();if(e.activeSubscriptions.length>0){const o=e.activeSubscriptions[0],n=await U.getCurrentSubscription(((t=r.currentUser)==null?void 0:t.id)||"");return n&&r.updateSubscription(n),{success:!0,customerInfo:e}}return{success:!1,error:"No active subscription to restore"}}catch(r){return console.error("Restore failed:",r),{success:!1,error:r}}},b=async()=>{try{return(await i.getCustomerInfo()).activeSubscriptions.length>0}catch(t){return console.error("Failed to check subscription status:",t),!1}},F=async()=>{try{const t=N();return await i.showManageSubscriptions(),{success:!0}}catch(t){return console.error("Failed to cancel subscription:",t),{success:!1,error:t}}},y=t=>{const r=new Date;return t.includes("yearly")?new Date(r.setFullYear(r.getFullYear()+1)):new Date(r.setMonth(r.getMonth()+1))},g=Object.freeze(Object.defineProperty({__proto__:null,cancelSubscription:F,checkSubscriptionStatus:b,getOfferings:h,initializeRevenueCat:v,purchaseSubscription:A,restoreSubscription:W},Symbol.toStringTag,{value:"Module"}));export{p as R,g as p};

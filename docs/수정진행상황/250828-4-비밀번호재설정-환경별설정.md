# 250828-4 ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • - í™˜ê²½ë³„ ì„¤ì • ê°€ì´ë“œ

## ë¬¸ì œ ì›ì¸
Capacitor ì•±ì—ì„œë„ `window.location.hostname`ì´ `localhost`ë¡œ ë‚˜íƒ€ë‚˜ê¸° ë•Œë¬¸ì—, ì•±ê³¼ ë¡œì»¬ ê°œë°œí™˜ê²½ì„ êµ¬ë¶„í•˜ì§€ ëª»í•˜ê³  ìˆì—ˆìŠµë‹ˆë‹¤.

## ìˆ˜ì •ëœ ë¡œì§
```javascript
// 1. ë¨¼ì € Capacitor ì•±ì¸ì§€ í™•ì¸ (ê°€ì¥ ì¤‘ìš”!)
if (Capacitor.isNativePlatform()) {
  // ì•±ì—ì„œ ì‹¤í–‰ ì¤‘ - ë”¥ë§í¬ ì‚¬ìš©
  redirectUrl = 'com.tarotgarden.app://auth/reset-password';
}
// 2. ê·¸ ë‹¤ìŒ ì›¹ í™˜ê²½ ì²´í¬
else if (window.location.hostname.includes('vercel.app')) {
  // Vercel ë°°í¬
  redirectUrl = `${window.location.origin}/auth/reset-password`;
}
// 3. ë¡œì»¬ ê°œë°œ (ë¸Œë¼ìš°ì €)
else if (window.location.hostname === 'localhost') {
  redirectUrl = `${window.location.origin}/auth/reset-password`;
}
```

## âš ï¸ ì¤‘ìš”: Supabase ëŒ€ì‹œë³´ë“œ ì„¤ì •

### ë°©ë²• 1: Redirect URLsì— ëª¨ë‘ ë“±ë¡ (ê¶Œì¥)
**Authentication â†’ URL Configuration â†’ Redirect URLs:**
```
com.tarotgarden.app://auth/reset-password
https://tarot-app-psi-eight.vercel.app/auth/reset-password
http://localhost:8082/auth/reset-password
```

### ë°©ë²• 2: Email Template ì§ì ‘ ìˆ˜ì •
**Authentication â†’ Email Templates â†’ Reset Password:**

ê¸°ë³¸ í…œí”Œë¦¿:
```html
<h2>Reset Password</h2>
<p>Follow this link to reset the password for your user:</p>
<p><a href="{{ .ConfirmationURL }}">Reset Password</a></p>
```

ìˆ˜ì •ì•ˆ (ì•±ê³¼ ì›¹ ë§í¬ ëª¨ë‘ ì œê³µ):
```html
<h2>ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •</h2>
<p>ì•„ë˜ ë§í¬ë¥¼ í´ë¦­í•˜ì—¬ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì¬ì„¤ì •í•˜ì„¸ìš”:</p>

<p><strong>íƒ€ë¡œì˜ ì •ì› ì•± ì‚¬ìš©ì:</strong></p>
<p><a href="{{ .ConfirmationURL }}">ì•±ì—ì„œ ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •</a></p>

<p><strong>ì›¹ ì‚¬ìš©ì:</strong></p>
<p><a href="https://tarot-app-psi-eight.vercel.app/auth/reset-password{{ .TokenHash }}">ì›¹ì—ì„œ ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •</a></p>
```

## í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ì•±ì—ì„œ í…ŒìŠ¤íŠ¸:
1. âœ… ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸° í´ë¦­
2. âœ… ì´ë©”ì¼ ì…ë ¥
3. âœ… ì½˜ì†” í™•ì¸: "ğŸ“± ì•± í™˜ê²½ ê°ì§€ - ë”¥ë§í¬ ì‚¬ìš©"
4. âœ… ì´ë©”ì¼ í™•ì¸: `com.tarotgarden.app://auth/reset-password` ë§í¬
5. âœ… ë§í¬ í´ë¦­ â†’ ì•± ì—´ë¦¼ â†’ ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • í˜ì´ì§€

### ë¡œì»¬ ë¸Œë¼ìš°ì € í…ŒìŠ¤íŠ¸:
1. âœ… localhost:8082ì—ì„œ ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°
2. âœ… ì½˜ì†” í™•ì¸: "ğŸ’» ë¡œì»¬ ê°œë°œ í™˜ê²½ ê°ì§€"  
3. âœ… ì´ë©”ì¼ í™•ì¸: `http://localhost:8082/auth/reset-password` ë§í¬

## ë””ë²„ê¹… ì •ë³´
ì½˜ì†”ì— ë‹¤ìŒ ì •ë³´ê°€ ì¶œë ¥ë©ë‹ˆë‹¤:
```javascript
{
  isNative: true/false,        // ì•±ì¸ì§€ ì—¬ë¶€
  hostname: "localhost",        // í˜¸ìŠ¤íŠ¸ëª…
  origin: "http://localhost",   // Origin
  platform: "android"/"web"     // í”Œë«í¼
}
```

## ì¶”ê°€ ê³ ë ¤ì‚¬í•­
ë§Œì•½ ì—¬ì „íˆ ë¬¸ì œê°€ ìˆë‹¤ë©´:
1. Supabase ëŒ€ì‹œë³´ë“œì—ì„œ Site URL ì„¤ì • í™•ì¸
2. Authentication â†’ Settings â†’ Email Auth â†’ Confirm email ë¹„í™œì„±í™” ê³ ë ¤
3. Supabase Edge Functions ì‚¬ìš©í•˜ì—¬ ë™ì  ë¦¬ë‹¤ì´ë ‰íŠ¸ êµ¬í˜„ ê³ ë ¤